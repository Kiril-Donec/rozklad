<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Розклад уроків 8-Г</title>

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Розклад 8-Г" />
    <meta property="og:description" content="Розклад уроків для 8-Г класу" />
    <meta property="og:url" content="https://kiril-donec.github.io/rozklad/" />
    <meta property="og:type" content="website" />

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            margin: 10px;
            /* Зменшено відступи для мобільних */
            padding: 10px;
            /* Зменшено відступи для мобільних */
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            flex: 1;
            overflow-x: auto;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            /* Зменшено відступ для мобільних */
            font-size: 2em;
            /* Зменшено розмір шрифту для мобільних */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            /* Зменшено відступ для мобільних */
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            padding: 8px 12px;
            /* Зменшено відступи для мобільних */
            cursor: pointer;
            color: #555;
            border-bottom: 2px solid transparent;
            transition: border-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
            white-space: nowrap;
            font-size: 0.9em;
            /* Зменшено розмір шрифту для мобільних */
            position: relative;
        }

        .tab:hover {
            transform: translateY(-2px);
        }

        .tab.active {
            border-bottom-color: #007bff;
            color: #007bff;
        }

        .schedule-wrapper {
            position: relative;
            opacity: 0;
            /* Початково приховуємо всі розклади */
            transition: opacity 0.5s ease;
        }

        .schedule-wrapper.active {
            opacity: 1;
        }

        .schedule-wrapper.slide-in-left {
            animation: slide-in-left 0.5s ease-in-out;
            /* Змінено тривалість та easing */
        }

        .schedule-wrapper.slide-in-right {
            animation: slide-in-right 0.5s ease-in-out;
            /* Змінено тривалість та easing */
        }

        @keyframes slide-in-left {
            0% {
                transform: translateX(-100%);
                opacity: 0;
            }

            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slide-in-right {
            0% {
                transform: translateX(100%);
                opacity: 0;
            }

            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .schedule {
            width: 100%;
            /* Розклад займає всю ширину контейнера */
            table-layout: fixed;
            /* Фіксована ширина стовпців */
            font-size: 0.9em;
            /* Зменшено розмір шрифту для мобільних */
        }

        .schedule th,
        .schedule td {
            border: 1px solid #ddd;
            padding: 8px;
            /* Зменшено відступи для мобільних */
            text-align: left;
            overflow: hidden;
            /* Приховуємо текст, що виходить за межі комірки */
            text-overflow: ellipsis;
            /* Додаємо три крапки в кінці тексту */
            white-space: nowrap;
            /* Забороняємо перенос тексту на новий рядок */
        }

        /* Зменшено ширину стовпчика нумерації */
        .schedule th:first-child,
        .schedule td:first-child {
            width: 5%; 
        }

        .schedule th {
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .lesson-time {
            font-size: 0.8em;
            /* Зменшено розмір шрифту для мобільних */
            color: #777;
        }

        .ds-label {
            display: inline-block;
            background-color: #007bff;
            color: #fff;
            padding: 2px 5px;
            border-radius: 4px;
            margin-right: 5px;
            font-size: 0.7em;
            /* Зменшено розмір шрифту для мобільних */
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .current-lesson {
            background-color: #e0f7fa;
            animation: pulse 1.5s infinite alternate;
        }

        /* Bell Schedule Styling */
        .bell-schedule th,
        .bell-schedule td {
            text-align: center;
        }

        .bell-schedule th:nth-child(1),
        .bell-schedule td:nth-child(1) {
            width: 20%;
        }

        .bell-schedule th:nth-child(2),
        .bell-schedule td:nth-child(2) {
            width: 50%;
        }

        .bell-schedule th:nth-child(3),
        .bell-schedule td:nth-child(3) {
            width: 30%;
        }

        /* Адаптація під мобільні пристрої */
        @media (max-width: 768px) {

            .container {
                margin: 5px;
                /* Зменшено відступи для мобільних */
                padding: 5px;
                /* Зменшено відступи для мобільних */
            }

            .tabs {
                flex-wrap: wrap;
                /* Дозволяємо вкладкам переноситися на новий рядок */
                justify-content: flex-start;
            }

            .tab {
                margin-bottom: 5px;
                /* Додаємо відступ між вкладками */
            }
        }

        /* Стиль для пунктів A, B */
        .lesson-list {
            text-align: center;
            /* Вирівнювання по центру */
            display: flex;
            /* Використовуємо flexbox */
            flex-direction: column;
            /* Елементи розташовуються один під одним */
            align-items: center;
            /* Вирівнювання по центру горизонтально */
        }

        .lesson-list li {
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            /* Вирівнювання по центру вертикально */
        }

        .lesson-list li span {
            padding: 5px 10px;
            border-radius: 5px;
            /* Закруглені кути */
        }

        .lesson-list li span:first-child {
            color: #fff;
            /* Білий текст */
            background-color: #007bff;
            /* Синій фон */
            margin-right: 5px;
            /* Невеликий відступ справа */
        }

        .lesson-list li span:last-child {
            color: #fff;
            /* Білий текст */
            background-color: #28a745;
            /* Зелений фон */
        }

        .lesson-list li:before {
            content: "ДС";
            /* Додаємо "ДС" */
            font-weight: bold;
            /* Робимо "ДС" жирним */
            margin-right: 10px;
            /* Відступ справа */
        }

        /* Стиль для роздільників між розкладами у вкладці "Всі" */
        #all .schedule-separator {
            margin-top: 20px;
            border-top: 1px solid #ddd;
        }

        /* Стиль для назви дня у вкладці "Всі" */
        #all .day-name {
            background-color: #f8f9fa;
            /* Світло-сірий фон */
            padding: 10px;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            /* Невеликий відступ знизу */
        }

        /* Стиль для годинника */
        #clock {
            text-align: center;
            font-size: 1.5em;
            margin-top: 10px;
        }

        /* Стиль для повідомлення "Скоро уроки" */
        .before-lessons {
            background-color: #e0f7fa;
            font-style: italic;
            font-size: 0.9em;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Розклад уроків 8-Г</h1>
        <div class="tabs">
            <div class="tab active" data-target="all">Всі</div>
            <div class="tab" data-target="monday">Пн</div>
            <div class="tab" data-target="tuesday">Вт</div>
            <div class="tab" data-target="wednesday">Ср</div>
            <div class="tab" data-target="thursday">Чт</div>
            <div class="tab" data-target="friday">Пт</div>
            <div class="tab" data-target="bell-schedule">Дзвінки</div>
        </div>

        <div id="all" class="schedule-wrapper active"></div>
        <div id="monday" class="schedule-wrapper"></div>
        <div id="tuesday" class="schedule-wrapper"></div>
        <div id="wednesday" class="schedule-wrapper"></div>
        <div id="thursday" class="schedule-wrapper"></div>
        <div id="friday" class="schedule-wrapper"></div>
        <div id="bell-schedule" class="schedule-wrapper"></div>
    </div>

    <script>
        const tabs = document.querySelectorAll('.tab');
        const scheduleWrappers = document.querySelectorAll('.schedule-wrapper');

        // Функція для створення таблиці розкладу
        function createScheduleTable(data, dayName) {
            const table = document.createElement('table');
            table.classList.add('schedule');
            const thead = table.createTHead();
            const tbody = table.createTBody();
            const headerRow = thead.insertRow();
            headerRow.insertCell().textContent = '№'; // Змінено на "№"
            headerRow.insertCell().textContent = 'Предмет';
            headerRow.insertCell().textContent = 'Час';

            let lessonCounter = 1; // Лічильник уроків
            let firstLessonFound = false; // Прапорець, що вказує, чи знайдено перший урок

            data.forEach((lesson, index) => {
                if (lesson.subject !== "" && !firstLessonFound) {
                    lessonCounter = index + 1; // Встановлюємо початкове значення лічильника
                    firstLessonFound = true;
                }

                if (firstLessonFound) {
                    const row = tbody.insertRow();
                    row.insertCell().textContent = lessonCounter; // Використовуємо лічильник уроків
                    const subjectCell = row.insertCell();

                    if (lesson.subject.includes("A:") && lesson.subject.includes("B:")) {
                        // Гарне форматування для A, B з ДС
                        const list = document.createElement('ul');
                        list.classList.add('lesson-list');
                        const parts = lesson.subject.split('\n');
                        parts.forEach(part => {
                            const li = document.createElement('li');
                            const [group, subject] = part.split(':').map(s => s.trim());
                            li.innerHTML = `<span>${group}</span> <span>${subject.replace("ДС ", "")}</span>`; // Видалення "ДС "
                            list.appendChild(li);
                        });
                        subjectCell.appendChild(list);
                    } else if (lesson.ds) {
                        subjectCell.innerHTML = `<span class="ds-label">ДС</span> ${lesson.subject}`;
                    } else {
                        subjectCell.textContent = lesson.subject;
                    }
                    row.insertCell().textContent = lesson.time;
                    lessonCounter++;
                }
            });

            // Додавання назви дня
            if (dayName) {
                const dayNameRow = table.insertRow(0);
                const dayNameCell = dayNameRow.insertCell();
                dayNameCell.colSpan = 3; // Об'єднання стовпців
                dayNameCell.textContent = dayName;
                dayNameCell.style.textAlign = "center";
                dayNameCell.style.fontWeight = "bold";
                dayNameRow.classList.add('day-name'); // Додавання класу для ігнорування в updateCurrentLessonInfo
            }

            return table;
        }

        // Функція для створення таблиці розкладу дзвінків
        function createBellScheduleTable(data) {
            const table = document.createElement('table');
            table.classList.add('schedule', 'bell-schedule');
            const thead = table.createTHead();
            const tbody = table.createTBody();
            const headerRow = thead.insertRow();
            headerRow.insertCell().textContent = 'Урок';
            headerRow.insertCell().textContent = 'Час';
            headerRow.insertCell().textContent = 'Перерва';

            data.forEach(lesson => {
                const row = tbody.insertRow();
                row.insertCell().textContent = lesson.lesson;
                row.insertCell().textContent = lesson.time;
                row.insertCell().textContent = lesson.break;
            });

            return table;
        }

        // Завантаження даних з rozklad.json
        fetch('rozklad.json')
            .then(response => response.json())
            .then(data => {
                // Створення таблиць розкладу для кожного дня
                document.getElementById('monday').appendChild(createScheduleTable(data.monday, "Понеділок"));
                document.getElementById('tuesday').appendChild(createScheduleTable(data.tuesday, "Вівторок"));
                document.getElementById('wednesday').appendChild(createScheduleTable(data.wednesday, "Середа"));
                document.getElementById('thursday').appendChild(createScheduleTable(data.thursday, "Четвер"));
                document.getElementById('friday').appendChild(createScheduleTable(data.friday, "П'ятниця"));
                document.getElementById('bell-schedule').appendChild(createBellScheduleTable(data.bellSchedule));

                // Створення розкладу для вкладки "Всі"
                const allSchedule = document.getElementById('all');
                allSchedule.appendChild(createScheduleTable(data.monday, "Понеділок"));
                allSchedule.appendChild(document.createElement('div')).classList.add('schedule-separator');
                allSchedule.appendChild(createScheduleTable(data.tuesday, "Вівторок"));
                allSchedule.appendChild(document.createElement('div')).classList.add('schedule-separator');
                allSchedule.appendChild(createScheduleTable(data.wednesday, "Середа"));
                allSchedule.appendChild(document.createElement('div')).classList.add('schedule-separator');
                allSchedule.appendChild(createScheduleTable(data.thursday, "Четвер"));
                allSchedule.appendChild(document.createElement('div')).classList.add('schedule-separator');
                allSchedule.appendChild(createScheduleTable(data.friday, "П'ятниця"));
                allSchedule.appendChild(document.createElement('div')).classList.add('schedule-separator');
                allSchedule.appendChild(createBellScheduleTable(data.bellSchedule)); // Додано розклад дзвінків

                // Визначення поточного дня тижня
                const currentDay = new Date().getDay();
                let defaultTab = 'all'; // За замовчуванням показуємо вкладку "Всі"

                if (currentDay === 0 || currentDay === 6) {
                    // Якщо субота або неділя, показуємо вкладку "Всі"
                } else {
                    switch (currentDay) {
                        case 1:
                            defaultTab = 'monday';
                            break;
                        case 2:
                            defaultTab = 'tuesday';
                            break;
                        case 3:
                            defaultTab = 'wednesday';
                            break;
                        case 4:
                            defaultTab = 'thursday';
                            break;
                        case 5:
                            defaultTab = 'friday';
                            break;
                    }
                }

                // Активація вкладки поточного дня при завантаженні сторінки
                document.querySelector(`.tab[data-target="${defaultTab}"]`).click();
            });

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const target = tab.dataset.target;

                // Приховуємо всі розклади перед відображенням нового
                scheduleWrappers.forEach(s => {
                    s.classList.remove('active', 'slide-in-left', 'slide-in-right');
                    s.style.display = 'none';
                });

                // Знаходимо розклад, який потрібно відобразити
                const newActive = document.getElementById(target);

                // Змінюємо активну вкладку
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Відображаємо новий розклад
                newActive.style.display = 'block';

                // Додаємо анімацію 
                setTimeout(() => {
                    // Використовуємо Array.from() для перетворення NodeList в масив
                    const currentIndex = Array.from(scheduleWrappers).indexOf(newActive);
                    const prevIndex = Array.from(scheduleWrappers).indexOf(document.querySelector('.schedule-wrapper.active'));

                    if (currentIndex > prevIndex) {
                        newActive.classList.add('slide-in-right');
                    } else {
                        newActive.classList.add('slide-in-left');
                    }

                    // Додавання класу 'active' після завершення анімації
                    newActive.addEventListener('animationend', () => {
                        newActive.classList.add('active');
                        updateCurrentLessonInfo(); // Оновлення інформації про урок/перерву
                    }, { once: true }); // Виконати обробник події тільки один раз
                }, 0); // Затримка для коректної роботи анімації 
            });
        });

        // Оновлення часу в реальному часі
        function updateClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
        }

        // Оновлення інформації про поточний урок/перерву та часу
        function updateCurrentLessonInfo() {
            const now = new Date();
            const currentDay = now.getDay();
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();

            const activeScheduleWrapper = document.querySelector('.schedule-wrapper.active');
            const lessons = activeScheduleWrapper.querySelectorAll('.schedule tbody tr:not(.day-name)');

            // Видалення старих повідомлень
            activeScheduleWrapper.querySelectorAll('.before-lessons').forEach(row => row.remove()); // Видалення повідомлення про початок уроків

            if (currentDay !== 0 && currentDay !== 6 && currentHour >= 5 && currentHour < 6) {
                // Додавання повідомлення "Уроки скоро" з 5 до 6 ранку, якщо не субота/неділя
                const beforeLessonsRow = document.createElement('tr');
                beforeLessonsRow.classList.add('before-lessons');
                beforeLessonsRow.innerHTML = `<td colspan="3">Уроки скоро</td>`;
                activeScheduleWrapper.querySelector('.schedule tbody').insertBefore(beforeLessonsRow, activeScheduleWrapper.querySelector('.schedule tbody tr:first-child'));
            } else {
                // Повідомлення про початок уроків за 30 хвилин
                if (currentDay !== 0 && currentDay !== 6) {
                    const firstLesson = lessons[0];
                    if (firstLesson) {
                        const timeParts = firstLesson.querySelector('td:last-child').textContent.split(' - ');
                        if (timeParts.length === 2) {
                            const startHour = parseInt(timeParts[0].split(':')[0]);
                            const startMinute = parseInt(timeParts[0].split(':')[1]);

                            const timeUntilFirstLesson = (startHour - currentHour) * 60 + (startMinute - currentMinute);
                            if (timeUntilFirstLesson <= 30 && timeUntilFirstLesson > 0) {
                                const beforeLessonsRow = document.createElement('tr');
                                beforeLessonsRow.classList.add('before-lessons');
                                beforeLessonsRow.innerHTML = `<td colspan="3">Через ${timeUntilFirstLesson} хв починаються уроки</td>`;
                                activeScheduleWrapper.querySelector('.schedule tbody').insertBefore(beforeLessonsRow, activeScheduleWrapper.querySelector('.schedule tbody tr:first-child'));
                            }
                        }
                    }
                }

                lessons.forEach((lesson, index) => {
                    lesson.classList.remove('current-lesson');
                    const timeParts = lesson.querySelector('td:last-child').textContent.split(' - ');

                    if (timeParts.length === 2) {
                        const startHour = parseInt(timeParts[0].split(':')[0]);
                        const startMinute = parseInt(timeParts[0].split(':')[1]);
                        const endHour = parseInt(timeParts[1].split(':')[0]);
                        const endMinute = parseInt(timeParts[1].split(':')[1]);

                        if (currentHour >= startHour && currentMinute >= startMinute && currentHour <= endHour && currentMinute <= endMinute) {
                            lesson.classList.add('current-lesson');

                            const timeLeft = (endHour - currentHour) * 60 + (endMinute - currentMinute);
                            lesson.querySelector('td:last-child').textContent += ` (закінчиться через ${timeLeft} хв)`;
                        } 
                    }
                });

            }

            updateClock(); // Оновлення часу
        }

        // Оновлення інформації про поточний урок/перерву та часу кожну секунду
        setInterval(updateCurrentLessonInfo, 1000);

        // Додавання елемента для відображення часу
        const clockElement = document.createElement('div');
        clockElement.id = 'clock';
        document.body.appendChild(clockElement);
    </script>
</body>

</html>